import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LogisticRegression
import joblib

# Load the trained dataset
df = pd.read_csv('transactions_week3_ready.csv')

# Display data shape
print("Dataset shape:", df.shape)

# Feature importance (top predictors)
model = LogisticRegression(max_iter=1000, class_weight='balanced', random_state=42)
X = df.drop('Class', axis=1)
y = df['Class']
model.fit(X, y)

importance = pd.DataFrame({
    'Feature': X.columns,
    'Coefficient': abs(model.coef_[0])
}).sort_values(by='Coefficient', ascending=False)

print("\nüîç Top Predictors of Fraud:")
print(importance.head(10))

# Save feature importance for Power BI
importance.to_csv('feature_importance.csv', index=False)
print("\n‚úÖ feature_importance.csv saved ‚Äî use it in Power BI.")
